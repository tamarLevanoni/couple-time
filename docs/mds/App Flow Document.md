# מסמך זרימת אפליקציה - מערכת ניהול השאלות משחקי זוגיות  

## 1. תהליך התחברות והרשאות  
### שלב 1: כניסה למערכת  
1. המשתמש גולש לעמוד הכניסה דרך דפדפן.  
2. לחיצה על "התחבר עם Google" מפעילה את OAuth 2.0 של Google.  
3. המערכת בודקת אם חשבון Google משויך למשתמש רשום במערכת.  

### שלב 2: ניתוב לפי הרשאות  
- **אם המשתמש הוא רכז מוקד**:  
  - המערכת מזהה את המוקד המשויך לו (מתוך גיליון `Centers`).  
  - ניתוב אוטומטי למסך הדשבורד של המוקד, עם נתונים רלוונטיים בלבד.  
- **אם המשתמש הוא מנהל מערכת**:  
  - ניתוב למסך דשבורד כללי עם נתונים מכל המוקדים.  
- **אם המשתמש לא רשום**:  
  - הצגת הודעת שגיאה: "אין לך הרשאה לגשת למערכת. פנה למנהל המערכת".  

---

## 2. תהליך יצירת השאלה חדשה  
### שלב 1: פתיחת טופס  
1. רכז לוחץ על "השאלה חדשה" במסך הדשבורד.  
2. המערכת פותחת טופס עם שלושה חלקים:  
   - **חלק א': פרטי שואל** (חיפוש/רישום).  
   - **חלק ב': בחירת משחק** (סינון לפי קטגוריה/זמינות).  
   - **חלק ג': הגדרת תאריכים** (השאלה + החזרה מתוכננת).  

### שלב 2: איתור/רישום שואל  
1. הרכז מחפש שואל קיים לפי טלפון/שם.  
   - **אם נמצא**: טעינה אוטומטית של פרטים והיסטוריית השאלות.  
   - **אם לא נמצא**: מעבר לטופס רישום חדש עם שדות חובה (שם, טלפון).  

### שלב 3: בחירת משחק  
1. הרכז מסנן את רשימת המשחקים לפי:  
   - **קטגוריה** (למשל: משחקי קלפים).  
   - **זמינות** (רק משחקים עם סטטוס "זמין" במוקד הנוכחי).  
2. בחירת משחק → המערכת מציגה פרטים נוספים (תמונה, תיאור, היסטוריית השאלות).  

### שלב 4: קביעת תאריכים  
1. ברירת מחדל:  
   - תאריך השאלה: היום.  
   - תאריך החזרה מתוכנן: היום + 7 ימים.  
2. אפשרות לשינוי תאריכים בלוח שנה אינטראקטיבי (מתואם עם Google Calendar).  

### שלב 5: אישור ושמירה  
1. הרכז לוחץ על "שמור" → המערכת מבצעת:  
   - עדכון סטטוס המשחק ל"מושאל" בגיליון `Games`.  
   - רישום ההשאלה בגיליון `Rentals` עם כל הפרטים.  
   - שליחת הודעת WhatsApp אוטומטית לשואל עם פרטי ההשאלה.  

---

## 3. תהליך החזרת משחק  
### שלב 1: איתור ההשאלה  
1. רכז לוחץ על "רישום החזרה" במסך הדשבורד.  
2. סינון ההשאלות לפי:  
   - **סטטוס**: "מושאל" או "איחור".  
   - **מוקד**: רק השאלות המשויכות למוקד הנוכחי.  
3. בחירת ההשאלה הרלוונטית מרשימת התוצאות.  

### שלב 2: עדכון פרטי החזרה  
1. הרכז מזין את תאריך ההחזרה בפועל (ברירת מחדל: היום).  
2. בדיקת תקינות המשחק:  
   - **אם תקין**: סימון "הוחזר כסדרו".  
   - **אם פגום**: סימון "נדרש תיקון" + תיאור התקלה.  

### שלב 3: אישור סופי  
1. לחיצה על "אשר החזרה" → המערכת מבצעת:  
   - עדכון סטטוס המשחק ל"זמין" בגיליון `Games`.  
   - עדכון סטטוס ההשאלה ל"הוחזר" בגיליון `Rentals`.  
   - שליחת טופס משוב אוטומטי לשואל דרך WhatsApp.  

---

## 4. תהליך ניהול איחורים  
### שלב 1: זיהוי איחור אוטומטי  
1. כל שעה, סקריפט רקע בודק את גיליון `Rentals`.  
2. כל השאלה עם תאריך החזרה שעבר וללא תאריך החזרה בפועל → מסומנת כ"איחור".  

### שלב 2: התראות וטיפול  
1. **התראה לרכז**:  
   - הודעת מערכת בצורת באנר אדום במסך הדשבורד.  
   - הודעת WhatsApp עם פרטי ההשאלה (שם שואל, משחק, תאריך איחור).  
2. **התראה למנהל**:  
   - אם האיחור לא טופל תוך 24 שעות → הודעת אימייל עם פירוט.  

### שלב 3: פעולות תיקון  
1. הרכז לוחץ על ההתראה → מעבר לעמוד ההשאלה.  
2. אפשרויות פעולה:  
   - **הארכת תקופה**: הזנת תאריך החזרה חדש + סיבה.  
   - **סימון כלא רלוונטי**: אם המשחק אבד/נהרס.  
   - **חיוב עיכוב**: אם מוגדר במערכת (מתואם עם אינטגרציית תשלומים עתידית).  

---

## 5. תהליך ניהול מלאי  
### שלב 1: עדכון סטטוס משחק  
1. במסך ניהול המלאי, הרכז בוחר משחק ולוחץ על "עדכון".  
2. בחירת סטטוס חדש:  
   - **זמין**: המשחק מוכן להשאלה.  
   - **פגום**: המשחק דורש תיקון (נדרש תיאור תקלה).  
   - **הוסר**: המשחק הוצא משימוש.  

### שלב 2: התראות אוטומטיות  
1. אם מלאי משחק יורד מתחת ל-3 יחידות → התראה למנהל.  
2. אם משחק מסומן כ"פגום" → התראה לצוות התחזוקה.  

### שלב 3: טיפול במשחקים פגומים  
1. צוות התחזוקה מעדכן את הסטטוס ל"בתיקון" לאחר הטיפול.  
2. אם המשחק תוקן → הסטטוס מתאפס ל"זמין".  

---

## 6. תהליך הפקת דוחות  
### שלב 1: בחירת פרמטרים  
1. מנהל מערכת לוחץ על "דוחות" במסך הדשבורד.  
2. סינון לפי:  
   - **טווח תאריכים**: חודש אחרון, רבעון, שנה.  
   - **מוקד**: כל המוקדים או מוקד ספציפי.  
   - **קטגוריה**: משחקי קלפים, משחקי לוח, וכו'.  

### שלב 2: עיבוד נתונים  
1. המערכת שולפת נתונים מגיליונות `Rentals`, `Games`, ו-`Users`.  
2. הצגת תוצאות ב:  
   - **גרף עמודות**: השוואת פעילות בין מוקדים.  
   - **טבלה אינטראקטיבית**: פירוט השאלות, איחורים, והחזרות.  

### שלב 3: ייצוא ושיתוף  
1. אפשרות לייצא את הדוח לפורמטים: PDF, Excel, CSV.  
2. שליחת הדוח באימייל לרשימת תפוצה מוגדרת.  

---

## 7. תהליך ניהול הרשאות (למנהל מערכת)  
### שלב 1: הוספת רכז חדש  
1. מנהל לוחץ על "ניהול משתמשים" → "הוסף רכז".  
2. הזנת פרטים: שם, אימייל, טלפון, ומוקד משויך.  
3. אישור → נשלחת הזמנה למייל הרכז עם קישור להרשמה.  

### שלב 2: עדכון הרשאות  
1. בחירת רכז קיים מרשימת המשתמשים.  
2. שינוי הרשאות:  
   - **הגבלת גישה למוקד ספציפי**.  
   - **ביטול הרשאות ניהול**.  

### שלב 3: מחיקת משתמש  
1. בחירת משתמש וללחוץ על "מחק".  
2. אימות פעולה → המשתמש מוסר מכל הגיליונות.  

---

## 8. אינטגרציה עם WhatsApp  
### שלב 1: קביעת תבניות הודעות  
1. מנהל מערכת מגדיר תבניות הודעות ב"הגדרות תקשורת":  
   - **תזכורת החזרה**: "שלום [שם], נא להחזיר את [משחק] עד [תאריך]."  
   - **טופס משוב**: "איך היה החוויה? לחץ כאן למשוב: [קישור]."  

### שלב 2: שליחת הודעות אוטומטית  
1. בעת אירועים ספציפיים (השאלה, איחור, החזרה), המערכת שולחת הודעה לפי התבנית.  
2. מעקב אחר סטטוס ההודעה: "נשלח", "נכשל", "נקרא".  

### שלב 3: ניתוח תגובות  
1. תגובות משוב משויכות אוטומטית להשאלה הרלוונטית.  
2. דירוגי משוב מוצגים בדשבורד המנהל.  

---

### הערות:  
- **תיאור מלא**: כל תהליך כולל כניסות, יציאות, החלטות, ואינטראקציות עם רכיבי המערכת.  
- **קישוריות**:  
  - תהליך ההשאלה מתואם עם [App Functionality Document](#) סעיף 2.2.  
  - תבניות ההודעות מתואמות עם [Design Instructions](#) סעיף 3.1.  
- **ויזואליזציה**: ניתן להוסיף תרשימי זרימה (Flowcharts) בנספח למסמך.  